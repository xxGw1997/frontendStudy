/**
 * å‘å¸ƒè®¢é˜…æ¨¡å¼
 * å‘å¸ƒè®¢é˜…æ¨¡å¼åŒ…å«äº†ä¸‰ä¸ªæ¨¡å—åˆ†åˆ«æ˜¯:"è®¢é˜…è€…"ã€"è°ƒåº¦ä¸­å¿ƒ"ã€"å‘å¸ƒè€…"
 * è¿™é‡Œçš„è°ƒåº¦ä¸­å¿ƒå°±ç›¸å½“äºŽä¸€ä¸ªä¸­é—´å±‚
 * ä¸¾ä¸ªæœ€è¿‘è‡ªå·±èº«è¾¹çš„æ —å­ðŸŒ°
 * æœ€è¿‘3070å‡ºæ¥äº†,è€Œæˆ‘å‰äº›æ—¶é—´åŠ äº†ä¸€ä¸ªç»„è£…ä¸»æœºçš„äººçš„wx,æˆ‘åªæ˜¯æƒ³ç®€å•é…ä¸€ä¸ªä¸»æœº,ä¸éœ€è¦å¾ˆé«˜çš„è¦æ±‚
 * é‚£äº›æƒ³è¦è´­ä¹°3070çš„äººå°±å±žäºŽè®¢é˜…è€…--->ðŸ‘¨
 * ç»„è£…ä¸»æœºçš„äººå°±ç›¸å½“äºŽè°ƒåº¦ä¸­å¿ƒ--->ðŸ“•
 * è€ŒçœŸæ­£ç ”å‘3070çš„åŽ‚å•†å°±å±žäºŽå‘å¸ƒè€…--->ðŸ­
 * åœ¨3070å‡ºæ¥ä¹‹å‰,å¾ˆå¤šäººðŸ‘¨ä¼šåœ¨ä¸­é—´äººðŸ“•é‚£é‡Œé¢„å®š,è€Œæˆ‘ðŸ‘¨è‡ªå·±æ²¡æœ‰é’±ä¹°ä¸èµ·3070,æ‰€ä»¥ä¹‹å‰å°±æ²¡æœ‰å’Œè£…æœºäººðŸ“•é¢„å®š3070
 * æ­¤æ—¶åœ¨è£…æœºäººðŸ“•é‚£é‡Œä¼šå°†è¿™äº›é¢„å®š3070çš„äººðŸ‘¨ç»™è®°å½•åˆ°ä¸€ä¸ªåå•,
 * ç­‰åˆ°3070æ­£å¼å‡ºæ¥ä¹‹åŽ,è£…æœºäººðŸ“•ä¼šä¾æ¬¡æŒ‰ç…§è¿™ä¸ªåå•åŽ»é€šçŸ¥è´­ä¹°è€…ðŸ‘¨å¯ä»¥è¿›è¡Œä»˜æ¬¾è´­ä¹°äº†,
 * ä½†æ˜¯ä»–ðŸ“•ä¸ä¼šä¸»åŠ¨åœ¨wxé€šçŸ¥æˆ‘ðŸ‘¨è¿›è¡Œè´­ä¹°,å› ä¸ºæˆ‘ðŸ‘¨æ²¡æœ‰é¢„å®š
 * è€Œåœ¨3070æ­£å¼å‘å¸ƒä¹‹å‰,è£…æœºäººðŸ“•ä¹Ÿä¸çŸ¥é“å…·ä½“ä»€ä¹ˆæ—¶å€™ä¼šæœ‰è´§,çœŸæ­£èƒ½å¤Ÿç”Ÿäº§å‡º3070çš„å…¶å®žæ˜¯åŽ‚å•†(å‘å¸ƒè€…)ðŸ­
 * åŽ‚å•†(å‘å¸ƒè€…)ðŸ­ç”Ÿäº§å‡ºè´§æ—¶,ç¬¬ä¸€æ—¶é—´è°ƒåº¦ä¸­å¿ƒè£…æœºäººðŸ“•ä¼šå¾—åˆ°æ¶ˆæ¯,è£…æœºäººðŸ“•å¾—åˆ°æ¶ˆæ¯åŽå°±ä¼šé€šçŸ¥è´­ä¹°è€…è¿›è¡Œè´­ä¹°äº†
 * æ‰€ä»¥è£…æœºäººèµ·åˆ°ä¸€ä¸ªä¸­é—´äººçš„ä½œç”¨
 * è´­ä¹°è€…éœ€è¦åœ¨è£…æœºäººé‚£é‡Œé¢„å®š3070,åœ¨è£…æœºäººé‚£é‡Œç”Ÿæˆä¸€ä»½åå•
 * å·¥åŽ‚æ­£å¼å‘å¸ƒ3070ä¹‹å‰å†…éƒ¨æ¶ˆæ¯ä¸ç›´æŽ¥é€šçŸ¥å¤§ä¼—,è€Œæ˜¯ä¼šå…ˆé€šçŸ¥è£…æœºäºº
 * è£…æœºäººå¾—åˆ°å‘å¸ƒè€…çš„é€šçŸ¥åŽ,æ‰ä¼šé€ä¸€é€šçŸ¥å„ä½ä¹°å®¶
 * è¿™ç§æ¨¡å¼çš„ä¸»è¦ä½œç”¨å°±æ˜¯:æ¯ä¸ªè§’è‰²éƒ½è´Ÿè´£å…¶ä¸“é—¨è´Ÿè´£çš„äº‹æƒ…,å°†æ¨¡å—ä¹‹é—´è¿›è¡Œè§£è€¦
 * è®¢é˜…è€…åªéœ€è¦è®¢é˜…æ¶ˆæ¯,åŽç»­åªè¦ç­‰å¾…æ‰§è¡Œä»»åŠ¡å°±è¡Œ
 * è°ƒåº¦ä¸­å¿ƒåˆ™è´Ÿè´£æ‰‹æœºè®¢é˜…å’Œé€šçŸ¥è®¢é˜…è€…æ‰§è¡Œä»»åŠ¡å°±è¡Œ
 * å‘å¸ƒè€…åªéœ€è¦è¿›è¡Œå‘å¸ƒæ¶ˆæ¯,è€Œä¸ç”¨é€šçŸ¥åˆ°æ¯ä¸€ä¸ªäººè°ƒç”¨ä»»åŠ¡.
 */

class Event {
  constructor() {
  }
  //è¿›è¡Œè®°å½•è®¢é˜…è€…çš„å›žè°ƒå¯¹è±¡,å¯¹è±¡ä¸€èˆ¬æ˜¯ä¸€äº›å¯¹åº”äº‹ä»¶çš„æ•°ç»„
  //æŸä¸ªäº‹ä»¶ä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè®¢é˜…è€…å›žè°ƒæ–¹æ³•
  events = {}

  //æ·»åŠ è®¢é˜…è€…çš„æ–¹æ³•
  _addEventListener(type, fn) {
    //é¦–å…ˆåœ¨eventsä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰typeäº‹ä»¶ç±»åž‹çš„æ•°ç»„å®¹å™¨
    //å¦‚æžœæœ‰,åˆ™åœ¨å¯¹åº”typeäº‹ä»¶å®¹å™¨ç›´æŽ¥æ”¾å…¥fnå›žè°ƒå°±è¡Œ
    //å¦‚æžœæ²¡æœ‰,åˆ™å…ˆåœ¨eventsåˆ›å»ºä¸€ä¸ªtypeäº‹ä»¶å®¹å™¨å†æ”¾å…¥fnå›žè°ƒ
    if (!this.events[type]) this.events[type] = []
    this.events[type].push(fn)
  }

  //å‘å¸ƒæ—¶,é€šçŸ¥äº‹ä»¶æ‰§è¡Œ
  _dispatchEvent(type, ...args) {
    this.events[type].forEach(fn => {
      fn(...args)
    });
  }

  //ç§»é™¤äº‹ä»¶,ä¸‡ä¸€åˆ«äººåæ‚”äº†å‘¢
  _removeEventListener(type, handler) {
    // æ— æ•ˆäº‹ä»¶æŠ›å‡º
    if (!(type in this.events)) {
      return new Error('æ— æ•ˆäº‹ä»¶')
    }
    if (!handler) {
      // ç›´æŽ¥ç§»é™¤äº‹ä»¶
      delete this.events[type]
    } else {
      const idx = this.events[type].findIndex(ele => ele === handler)
      // æŠ›å‡ºå¼‚å¸¸äº‹ä»¶
      if (idx === -1) {
        return new Error('æ— è¯¥ç»‘å®šäº‹ä»¶')
      }
      // ç§»é™¤äº‹ä»¶
      this.events[type].splice(idx, 1)
      if (this.events[type].length === 0) {
        delete this.events[type]
      }
    }
  }
}




//test
//åœ¨node çŽ¯å¢ƒä¸‹æŠ¥é”™,è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢
let event = new Event()
function clock() {
  console.log('é“ƒé“ƒé“ƒ~èµ·åºŠå•¦')
}

event.addEventListener('wakeUp', clock)
event.dispatchEvent('wakeUp')